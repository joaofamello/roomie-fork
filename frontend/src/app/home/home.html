<ng-container *ngIf="!hasSearched">
  <div class="hero-container">

    <header class="topbar-blue">
      <h2 class="logo-text">Roomie</h2>
      <div class="header-buttons">
        <button class="profile-btn" (click)="goToCreateProperty()">+ Anunciar Imóvel</button>

        <button class="profile-btn" (click)="goToProfile()">Meu Perfil</button>
        <button class="profile-btn" (click)="onLogout()">Sair</button>
      </div>
    </header>

    <div class="hero-content">
      <h1>Encontre seu novo lar.</h1>
      <p>Repúblicas, quartos e apartamentos para dividir com a sua vibe.</p>

      <div class="big-search-box">
        <input 
          type="text" 
          [formControl]="initialSearch" 
          placeholder="Para qual cidade ou bairro você vai?"
          (keyup.enter)="onInitialSearch()" 
        />
        <button class="btn-big-search" (click)="onInitialSearch()">Buscar</button>
      </div>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="hasSearched">
  <div class="dashboard-container">

    <header class="topbar-blue">
      <h2 class="logo-text" (click)="goBackHome()" style="cursor: pointer;" title="Voltar ao Início">Roomie</h2>
      <div class="header-buttons">
        <button class="profile-btn" (click)="goToCreateProperty()">+ Anunciar Imóvel</button>

        <button class="profile-btn" (click)="goToProfile()">Meu Perfil</button>
        <button class="profile-btn" (click)="onLogout()">Sair</button>
      </div>
      
    </header>

    <div class="search-section" [formGroup]="filterForm">
      <div class="search-bar">
        <input
          type="text"
          formControlName="location"
          placeholder="Buscar por cidade..."
          (keyup.enter)="onFilter()"
        />
        <button class="btn-search" (click)="onFilter()">Buscar</button>
      </div>
    </div>

    <div class="main-content">
      <aside class="sidebar">
        <h3>Filtros</h3>
        <form [formGroup]="filterForm" (ngSubmit)="onFilter()">

          <div class="filter-group">
            <label>Bairro</label>
            <input type="text" formControlName="district" placeholder="Ex: Boa Vista" />
          </div>

          <div class="filter-group price-group">
            <div>
              <label>Preço Mín.</label>
              <input type="number" formControlName="minPrice" placeholder="R$ 0" />
            </div>
            <div>
              <label>Preço Máx.</label>
              <input type="number" formControlName="maxPrice" placeholder="R$ 2000" />
            </div>
          </div>

          <div class="filter-group">
            <label>Tipo de Imóvel</label>
            <select formControlName="propertyType">
              <option value="">Todos os tipos</option>
              <option value="HOUSE">Casa</option>
              <option value="APARTMENT">Apartamento</option>
              <option value="ROOM">Quarto Individual</option>
              <option value="REPUBLIC">República</option>
            </select>
          </div>

          <button type="button" class="btn-filter" (click)="onFilter()">Aplicar Filtros</button>
        </form>
      </aside>

      <section class="results-area">
        <div class="results-header">
          <h2>Resultados da Busca</h2>
          <p>Mostrando imóveis para: <strong>{{ appliedLocation || 'Qualquer lugar' }}</strong></p>
        </div>

        <app-property-list 
           [properties]="properties" 
           [loading]="isLoading">
        </app-property-list>

      </section>

    </div>
  </div>
</ng-container>